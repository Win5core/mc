"use strict";(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[4751],{3546:function(e,t,n){n(72791);var a=n(31363),r=n(28282),s=n(39230),l=n(80184);t.Z=function(e){var t=e.icon,n=e.color,i=e.label,o=e.children,u=(0,s.$G)().t;return(0,l.jsx)(r.Z.Header,{children:(0,l.jsxs)("h6",{className:"col-black",style:{width:"100%"},children:[(0,l.jsx)(a.G,{icon:t,className:"col-"+n})," ",i.length?u(i):i,o]})})}},52225:function(e,t,n){var a=n(37762),r=n(74165),s=n(15861),l=n(29439),i=n(72791),o=n(28282),u=n(89743),c=n(2677),d=n(3546),m=n(11632),p=n(39230),f=n(96271),h=n(86529),b=n(99220),x=n(38646),y=n(28782),g=n(27949),v=n(98442),k=n(66360),Z=n(35751),j=n(15101),N=n(76308),D=n(89114),w=n(31363),M=n(16850),S=n(80184),E=864e5,C=function(e){var t=new Date(e.getFullYear(),0,1),n=(new Date(e.getFullYear(),e.getMonth(),e.getDate())-t+864e5)/864e5;return Math.ceil(n/7)};t.Z=function(e){var t=e.identifier,n=(0,p.$G)().t,A=(0,N.Fg)().nightModeEnabled,T=(0,D.H)().setHelpModalTopic,O=(0,i.useCallback)((function(){return T("player-retention-graph")}),[T]),L=(0,i.useMemo)((function(){return(new Date).getTime()}),[]),_=(0,b.m)(x.X6,[t]),F=_.data,P=_.loadingError,I=(0,b.m)(x.Nt,[t]),Y=I.data,H=I.loadingError,R=(0,i.useState)("days"),U=(0,l.Z)(R,2),B=U[0],z=U[1],G=(0,i.useMemo)((function(){return[{name:"hours",displayName:n("html.label.time.hours"),increment:36e5},{name:"days",displayName:n("html.label.time.days"),increment:E},{name:"weeks",displayName:n("html.label.time.weeks"),increment:7*E},{name:"months",displayName:n("html.label.time.months"),increment:30*E}]}),[n]),$=(0,i.useState)("registered-7d"),K=(0,l.Z)($,2),X=K[0],V=K[1],W=(0,i.useMemo)((function(){return[{name:"registered-7d",displayName:n("html.label.retention.inLast7d"),start:L-7*E},{name:"registered-30d",displayName:n("html.label.retention.inLast30d"),start:L-30*E},{name:"registered-3m",displayName:n("html.label.retention.inLast90d"),start:L-90*E},{name:"registered-6m",displayName:n("html.label.retention.inLast180d"),start:L-180*E},{name:"registered-1y",displayName:n("html.label.retention.inLast365d"),start:L-365*E},{name:"registered-2y",displayName:n("html.label.retention.inLast730d"),start:L-730*E},{name:"registered-ever",displayName:n("html.label.retention.inAnytime"),start:0}]}),[n,L]),q=(0,i.useState)("none"),J=(0,l.Z)(q,2),Q=J[0],ee=J[1],te=(0,i.useMemo)((function(){return[{name:"none",displayName:n("html.label.retention.groupByNone")},{name:"days",displayName:n("html.label.time.day")},{name:"weeks",displayName:n("html.label.time.week")},{name:"months",displayName:n("html.label.time.month")},{name:"years",displayName:n("html.label.time.year")},{name:"joinAddress",displayName:n("html.label.joinAddress")}]}),[n]),ne=(0,i.useState)("percentage"),ae=(0,l.Z)(ne,2),re=ae[0],se=ae[1],le=(0,i.useMemo)((function(){return[{name:"percentage",displayName:n("html.label.unit.percentage")},{name:"count",displayName:n("html.label.unit.playerCount")},{name:"count-stacked",displayName:n("html.label.unit.playerCount")+" ("+n("html.label.stacked")+")"}]}),[n]),ie=(0,i.useState)("time"),oe=(0,l.Z)(ie,2),ue=oe[0],ce=oe[1],de=(0,i.useMemo)((function(){return[{name:"time",displayName:n("html.label.retention.timeSinceRegistered")},{name:"playtime",displayName:n("html.label.playtime")},{name:"date",displayName:n("html.label.time.date")},{name:"deltas",displayName:n("html.label.time.date")+" > "+n("html.label.registered")}]}),[n]),me=(0,i.useState)([]),pe=(0,l.Z)(me,2),fe=pe[0],he=pe[1],be=(0,i.useState)({title:{text:""}}),xe=(0,l.Z)(be,2),ye=xe[0],ge=xe[1],ve=(0,i.useCallback)(function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,n){var a,s,l,i,o,u,c,d,m,p,f,h,b,x,y,g,v,k,Z;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.length,l=G.find((function(e){return e.name===B})).increment,i=de.find((function(e){return e.name===ue})).name,e.t0=i,e.next="deltas"===e.t0?6:"date"===e.t0?20:"time"===e.t0?33:(e.t0,45);break;case 6:o=[],u=t[0].registerDate-t[0].registerDate%l,c=-1,d=(0,r.Z)().mark((function e(n){var s,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=function(e){return e.registerDate<=n&&e.lastSeenDate>=n},l=t.filter(s).length,o.push([n,"percentage"===re?100*l/a:l]),!(c===l&&l<=.5)){e.next=5;break}return e.abrupt("return",1);case 5:(-1!==c||l>0)&&(c=l);case 6:case"end":return e.stop()}}),e)})),m=u;case 11:if(!(m<L)){e.next=18;break}return e.delegateYield(d(m),"t1",13);case 13:if(!e.t1){e.next=15;break}return e.abrupt("break",18);case 15:m+=l,e.next=11;break;case 18:return s=o,e.abrupt("break",57);case 20:p=[],f=t[0].registerDate-t[0].registerDate%l,h=(0,r.Z)().mark((function e(n){var s,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=function(e){return e.lastSeenDate>=n},l=t.filter(s).length,p.push([n,"percentage"===re?100*l/a:l]),!(l<.5)){e.next=5;break}return e.abrupt("return",1);case 5:case"end":return e.stop()}}),e)})),b=f;case 24:if(!(b<L)){e.next=31;break}return e.delegateYield(h(b),"t2",26);case 26:if(!e.t2){e.next=28;break}return e.abrupt("break",31);case 28:b+=l,e.next=24;break;case 31:return s=p,e.abrupt("break",57);case 33:x=[],y=(0,r.Z)().mark((function e(n){var s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.filter((function(e){return e.timeDifference>n})).length,x.push([n/l,"percentage"===re?100*s/a:s]),!(s<.5)){e.next=4;break}return e.abrupt("return",1);case 4:case"end":return e.stop()}}),e)})),g=0;case 36:if(!(g<L)){e.next=43;break}return e.delegateYield(y(g),"t3",38);case 38:if(!e.t3){e.next=40;break}return e.abrupt("break",43);case 40:g+=l,e.next=36;break;case 43:return s=x,e.abrupt("break",57);case 45:v=[],k=(0,r.Z)().mark((function e(s){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.filter((function(e){return e.playtime>s-n})).length,v.push([(s-n)/l,"percentage"===re?100*i/a:i]),!(i<.5)){e.next=4;break}return e.abrupt("return",1);case 4:case"end":return e.stop()}}),e)})),Z=n;case 48:if(!(Z<L)){e.next=55;break}return e.delegateYield(k(Z),"t4",50);case 50:if(!e.t4){e.next=52;break}return e.abrupt("break",55);case 52:Z+=l,e.next=48;break;case 55:return s=v,e.abrupt("break",57);case 57:return e.abrupt("return",s);case 58:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[B,G,ue,de,re,L]),ke=(0,i.useCallback)(function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,n){var s,l,i,o,u,c,d,m,p,f,h;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s={},l=te.find((function(e){return e.name===Q})).name,i=(0,a.Z)(t),e.prev=3,i.s();case 5:if((o=i.n()).done){e.next=36;break}u=o.value,(c=new Date).setTime(u.registerDate),e.t0=l,e.next="days"===e.t0?12:"weeks"===e.t0?16:"months"===e.t0?20:"years"===e.t0?24:"joinAddress"===e.t0?28:(e.t0,32);break;case 12:return d=c.toISOString().substring(0,10),s[d]||(s[d]=[]),s[d].push(u),e.abrupt("break",34);case 16:return m=c.getUTCFullYear()+"-week-"+C(c),s[m]||(s[m]=[]),s[m].push(u),e.abrupt("break",34);case 20:return p=c.toISOString().substring(0,7),s[p]||(s[p]=[]),s[p].push(u),e.abrupt("break",34);case 24:return f=c.getUTCFullYear(),s[f]||(s[f]=[]),s[f].push(u),e.abrupt("break",34);case 28:return h=n[u.playerUUID],s[h]||(s[h]=[]),s[h].push(u),e.abrupt("break",34);case 32:return s.all=t,e.abrupt("break",34);case 34:e.next=5;break;case 36:e.next=41;break;case 38:e.prev=38,e.t1=e.catch(3),i.e(e.t1);case 41:return e.prev=41,i.f(),e.finish(41);case 44:return e.abrupt("return",s);case 45:case"end":return e.stop()}}),e,null,[[3,38,41,44]])})));return function(t,n){return e.apply(this,arguments)}}(),[te,Q]),Ze=(0,i.useCallback)(function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,n){var a,l,i,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=W.find((function(e){return e.name===X})).start,l=t.filter((function(e){return e.registerDate>a})).sort((function(e,t){return e.registerDate-t.registerDate})),e.next=4,ke(l,n);case 4:return i=e.sent,o=1,e.abrupt("return",Promise.all(Object.entries(i).map(function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n,s,l,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t[0],s=t[1],l=(0,k.KN)((0,k.WE)((0,k.S0)(o))),o++,e.next=6,ve(s,a);case 6:if((i=e.sent).filter((function(e){return 0===e[1]})).length!==i.length){e.next=9;break}return e.abrupt("return",[]);case 9:return e.abrupt("return",[{name:n,type:"count-stacked"===re?"areaspline":"spline",tooltip:v.Md.twoDecimals,data:i,color:A?(0,k.Xf)(l):l}]);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[A,ve,W,X,re,ke]);return(0,i.useEffect)((function(){F&&Y&&Ze(F.player_retention,Y.join_address_by_player).then((function(e){return he(e.flat())}))}),[F,Y,Ze,he]),(0,i.useEffect)((function(){var e=G.find((function(e){return e.name===B})).displayName,t=n("percentage"===re?"html.label.retention.retainedPlayersPercentage":"html.label.players"),a=de.find((function(e){return e.name===ue})).displayName;ge({title:{text:""},rangeSelector:"date"===ue?{selected:2,buttons:[{type:"day",count:7,text:"7d"},{type:"month",count:1,text:"30d"},{type:"all",text:"All"}]}:void 0,chart:{zooming:{type:"xy"}},plotOptions:{areaspline:{fillOpacity:A?.2:.4,stacking:"normal"}},legend:{enabled:"none"!==Q},xAxis:{zoomEnabled:!0,title:{text:"date"===ue||"deltas"===ue?n("html.label.time.date"):a+" ("+e+")"}},yAxis:{zoomEnabled:!0,title:{text:t},max:"percentage"===re?100:void 0,min:0},tooltip:"date"===ue||"deltas"===ue?{enabled:!0,valueDecimals:2,pointFormat:("none"!==Q?"{series.name} - ":"")+"<b>{point.y} "+("percentage"===re?"%":n("html.label.players"))+"</b>"}:{enabled:!0,valueDecimals:2,headerFormat:"{point.x} "+e+"<br>",pointFormat:("none"!==Q?"{series.name} - ":"")+"<b>{point.y} "+("percentage"===re?"%":n("html.label.players"))+"</b>"},series:fe})}),[n,A,fe,Q,de,ue,G,B,re]),P?(0,S.jsx)(y.NY,{error:P}):H?(0,S.jsx)(y.NY,{error:H}):F&&Y?(0,S.jsxs)(o.Z,{children:[(0,S.jsx)(d.Z,{icon:m.UFF,color:"indigo",label:n("html.label.playerRetention"),children:(0,S.jsx)("button",{className:"float-end",onClick:O,children:(0,S.jsx)(w.G,{className:"col-blue",icon:M.sph})})}),(0,S.jsxs)(f.Z,{id:"card-body-"+(t?"server-":"network-")+"player-retention",children:[(0,S.jsxs)(u.Z,{children:[(0,S.jsxs)(c.Z,{children:[(0,S.jsx)("label",{children:n("html.label.retention.timeStep")}),(0,S.jsx)(h.d,{selected:B,options:G,onChange:z})]}),(0,S.jsxs)(c.Z,{children:[(0,S.jsx)("label",{children:n("html.label.retention.playersRegisteredInTime")}),(0,S.jsx)(h.d,{selected:X,options:W,onChange:V})]}),(0,S.jsxs)(c.Z,{children:[(0,S.jsx)("label",{children:n("html.label.retention.groupByTime")}),(0,S.jsx)(h.d,{selected:Q,options:te,onChange:ee})]}),(0,S.jsxs)(c.Z,{children:[(0,S.jsx)("label",{children:n("html.label.xAxis")}),(0,S.jsx)(h.d,{selected:ue,options:de,onChange:ce})]}),(0,S.jsxs)(c.Z,{children:[(0,S.jsx)("label",{children:n("html.label.yAxis")}),(0,S.jsx)(h.d,{selected:re,options:le,onChange:se})]})]}),(0,S.jsx)("hr",{}),"date"!==ue&&"deltas"!==ue&&(0,S.jsx)(j.Z,{id:"retention-graph",options:ye,tall:!0}),("date"===ue||"deltas"===ue)&&(0,S.jsx)(Z.Z,{id:"retention-graph",options:ye,tall:!0})]})]}):(0,S.jsx)(g.ym,{})}},15101:function(e,t,n){var a=n(39230),r=n(76308),s=n(72791),l=n(41900),i=n.n(l),o=n(29718),u=n.n(o),c=n(75193),d=n.n(c),m=n(80184);t.Z=function(e){var t=e.id,n=e.series,l=e.legendEnabled,o=e.tall,c=e.yPlotLines,p=e.yPlotBands,f=e.xPlotLines,h=e.xPlotBands,b=e.options,x=(0,a.$G)().t,y=(0,r.Fg)(),g=y.graphTheming,v=y.nightModeEnabled;(0,s.useEffect)((function(){i()(u()),d()(u()),u().setOptions({lang:{noData:x("html.label.noDataToDisplay")}}),u().setOptions(g),u().chart(t,b||{chart:{noData:x("html.label.noDataToDisplay")},yAxis:{plotLines:c,plotBands:p},xAxis:{softMin:-.5,plotLines:f,plotBands:h},title:{text:""},plotOptions:{areaspline:{fillOpacity:v?.2:.4}},legend:{enabled:l},series:n})}),[b,n,t,x,g,v,l,c,p,f,h]);var k=o?{height:"450px"}:void 0;return(0,m.jsx)("div",{className:"chart-area",style:k,id:t,children:(0,m.jsx)("span",{className:"loader"})})}},35751:function(e,t,n){var a=n(37762),r=n(29439),s=n(76308),l=n(72791),i=n(98442),o=n(67179),u=n.n(o),c=n(41900),d=n.n(c),m=n(75193),p=n.n(m),f=n(39230),h=n(93490),b=n(80184);t.Z=function(e){var t=e.id,n=e.series,o=e.legendEnabled,c=e.tall,m=e.yAxis,x=e.selectedRange,y=e.extremes,g=e.onSetExtremes,v=e.alreadyOffsetTimezone,k=e.options,Z=e.extraModules,j=(0,f.$G)().t,N=(0,s.Fg)(),D=N.graphTheming,w=N.nightModeEnabled,M=(0,h.A)().timeZoneOffsetMinutes,S=(0,l.useState)(void 0),E=(0,r.Z)(S,2),C=E[0],A=E[1];(0,l.useEffect)((function(){if(d()(u()),p()(u()),Z){var e,r=(0,a.Z)(Z);try{for(r.s();!(e=r.n()).done;){(0,e.value)(u())}}catch(s){r.e(s)}finally{r.f()}}u().setOptions({lang:{noData:j("html.label.noDataToDisplay")}}),u().setOptions(D),A(u().stockChart(t,k||{chart:{noData:j("html.label.noDataToDisplay")},rangeSelector:{selected:void 0!==x?x:2,buttons:i.AA},yAxis:m||{softMax:2,softMin:0},xAxis:{events:{afterSetExtremes:function(e){g&&g(e)}}},title:{text:""},plotOptions:{areaspline:{fillOpacity:w?.2:.4}},legend:{enabled:o},time:{timezoneOffset:v?0:M},series:n}))}),[k,Z,n,t,j,D,w,v,M,o,m,g,A,x]),(0,l.useEffect)((function(){var e;null!==C&&void 0!==C&&null!==(e=C.xAxis)&&void 0!==e&&e.length&&y&&C.xAxis[0].setExtremes(y.min,y.max)}),[C,y]);var T=c?{height:"450px"}:void 0;return(0,b.jsx)("div",{className:"chart-area",style:T,id:t,children:(0,b.jsx)("span",{className:"loader"})})}},86529:function(e,t,n){n.d(t,{d:function(){return s}});var a=n(72791),r=n(80184),s=function(e){var t=e.selected,n=e.onChange,s=e.options,l=(0,a.useCallback)((function(e){var t=e.target;n(t.value)}),[n]);return(0,r.jsx)("select",{onChange:l,className:"form-select form-select-sm",defaultValue:t,children:s.map((function(e,t){return(0,r.jsx)("option",{value:e.name,disabled:e.disabled,children:e.displayName},e.name)}))})}},96271:function(e,t,n){var a=n(74165),r=n(15861),s=n(29439),l=n(72791),i=n(28282),o=n(33778),u=n(80184);t.Z=function(e){var t=e.id,n=e.className,c=e.children,d=(0,l.useState)([]),m=(0,s.Z)(d,2),p=m[0],f=m[1],h=(0,l.useState)([]),b=(0,s.Z)(h,2),x=b[0],y=b[1],g=(0,o.C)(),v=g.onRender,k=g.onUnmount,Z=g.context,j=(0,l.useCallback)((0,r.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=2;break}return e.abrupt("return");case 2:return e.t0=f,e.next=5,v(t,"beforeElement",Z);case 5:return e.t1=e.sent,(0,e.t0)(e.t1),e.t2=y,e.next=10,v(t,"afterElement",Z);case 10:e.t3=e.sent,(0,e.t2)(e.t3);case 12:case"end":return e.stop()}}),e)}))),[f,y,t,v,Z]);return(0,l.useEffect)((function(){return j(),function(){k&&(f([]),y([]),k(t,"beforeElement"),k(t,"afterElement"))}}),[f,y,t,k,j]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{dangerouslySetInnerHTML:{__html:p.join("")}}),(0,u.jsx)(i.Z.Body,{id:t,className:n?"extendable "+n:"extendable",children:c}),(0,u.jsx)("div",{dangerouslySetInnerHTML:{__html:x.join("")}})]})}},2936:function(e,t,n){var a=n(74165),r=n(15861),s=n(29439),l=n(72791),i=n(89743),o=n(33778),u=n(80184);t.Z=function(e){var t=e.id,n=e.className,c=e.children,d=(0,l.useState)([]),m=(0,s.Z)(d,2),p=m[0],f=m[1],h=(0,l.useState)([]),b=(0,s.Z)(h,2),x=b[0],y=b[1],g=(0,o.C)(),v=g.onRender,k=g.onUnmount,Z=g.context,j=(0,l.useCallback)((0,r.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=2;break}return e.abrupt("return");case 2:return e.t0=f,e.next=5,v(t,"beforeElement",Z);case 5:return e.t1=e.sent,(0,e.t0)(e.t1),e.t2=y,e.next=10,v(t,"afterElement",Z);case 10:e.t3=e.sent,(0,e.t2)(e.t3);case 12:case"end":return e.stop()}}),e)}))),[f,y,t,v,Z]);return(0,l.useEffect)((function(){return j(),function(){k&&(f([]),y([]),k(t,"beforeElement"),k(t,"afterElement"))}}),[f,y,t,k,j]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{dangerouslySetInnerHTML:{__html:p.join("")}}),(0,u.jsx)(i.Z,{id:t,className:n?"extendable "+n:"extendable",children:c}),(0,u.jsx)("div",{dangerouslySetInnerHTML:{__html:x.join("")}})]})}},27949:function(e,t,n){n.d(t,{aC:function(){return l},ym:function(){return s}});n(72791);var a=n(28282),r=n(80184),s=function(){return(0,r.jsxs)(a.Z,{className:"loading",children:[(0,r.jsx)(a.Z.Header,{children:(0,r.jsx)("h6",{className:"col-black",children:"..."})}),(0,r.jsx)(l,{})]})},l=function(e){var t=e.style;return(0,r.jsx)("div",{className:"chart-area loading",style:t,children:(0,r.jsx)(i,{})})},i=function(){return(0,r.jsx)("span",{className:"loader"})};t.ZP=i},98442:function(e,t,n){n.d(t,{AA:function(){return a},ET:function(){return s},Md:function(){return r},px:function(){return l}});var a=[{type:"hour",count:12,text:"12h"},{type:"hour",count:24,text:"24h"},{type:"day",count:7,text:"7d"},{type:"month",count:1,text:"30d"},{type:"all",text:"All"}],r={twoDecimals:{valueDecimals:2},zeroDecimals:{valueDecimals:0}},s=function(e){var t=[],n=[],a=[],r=[],s=[],l=[],i=[];return new Promise((function(o){var u=0,c=e.length;!function d(){for(var m=Math.min(u+1e3,c);u<m;u++){var p=e[u],f=p[0];t[u]=[f,p[1]],n[u]=[f,p[2]],a[u]=[f,p[3]],r[u]=[f,p[4]],s[u]=[f,p[5]],l[u]=[f,p[6]],i[u]=[f,p[7]]}u>=c?o({playersOnline:t,tps:n,cpu:a,ram:r,entities:s,chunks:l,disk:i}):setTimeout(d,10)}()}))},l={PLAYERS_ONLINE:{labels:{formatter:function(){return this.value+" P"}},softMin:0,softMax:2},TPS:{opposite:!0,labels:{formatter:function(){return this.value+" TPS"}},softMin:0,softMax:20},CPU:{opposite:!0,labels:{formatter:function(){return this.value+"%"}},softMin:0,softMax:100},RAM_OR_DISK:{labels:{formatter:function(){return this.value+" MB"}},softMin:0},ENTITIES:{opposite:!0,labels:{formatter:function(){return this.value+" E"}},softMin:0,softMax:2},CHUNKS:{labels:{formatter:function(){return this.value+" C"}},softMin:0}}}}]);
//# sourceMappingURL=4751.9cfe74c4.chunk.js.map
